var e,t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function n(e){return e&&e.__esModule?e.default:e}var i={},r={},o=t.parcelRequire3a11;null==o&&((o=function(e){if(e in i)return i[e].exports;if(e in r){var t=r[e];delete r[e];var n={id:e,exports:{}};return i[e]=n,t.call(n.exports,n,n.exports),n.exports}var o=Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){r[e]=t},t.parcelRequire3a11=o);var a={},s={},c=function(e){return e&&e.Math==Math&&e};s=c("object"==typeof globalThis&&globalThis)||c("object"==typeof window&&window)||c("object"==typeof self&&self)||c("object"==typeof t&&t)||Function("return this")();"use strict";var u={},l={};u=!(l=function(e){try{return!!e()}catch(e){return!0}})(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]});var d={}.propertyIsEnumerable,h=Object.getOwnPropertyDescriptor;tj=h&&!d.call({1:2},1)?function(e){var t=h(this,e);return!!t&&t.enumerable}:d;var p={};p=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}};var f={},m={},g={},y={}.toString;g=function(e){return y.call(e).slice(8,-1)};var v="".split;m=l(function(){return!Object("z").propertyIsEnumerable(0)})?function(e){return"String"==g(e)?v.call(e,""):Object(e)}:Object;var w={};w=function(e){if(void 0==e)throw TypeError("Can't call method on "+e);return e},f=function(e){return m(w(e))};var b={},_={};_=function(e){return"object"==typeof e?null!==e:"function"==typeof e},b=function(e,t){var n,i;if(!_(e))return e;if(t&&"function"==typeof(n=e.toString)&&!_(i=n.call(e))||"function"==typeof(n=e.valueOf)&&!_(i=n.call(e))||!t&&"function"==typeof(n=e.toString)&&!_(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")};var k={},I={}.hasOwnProperty;k=function(e,t){return I.call(e,t)};var S={},T={},O=s.document,E=_(O)&&_(O.createElement);T=function(e){return E?O.createElement(e):{}},S=!u&&!l(function(){return 7!=Object.defineProperty(T("div"),"a",{get:function(){return 7}}).a});var j=Object.getOwnPropertyDescriptor;tE=u?j:function(e,t){if(e=f(e),t=b(t,!0),S)try{return j(e,t)}catch(e){}if(k(e,t))return p(!tj.call(e,t),e[t])};var L={},x={};x=function(e){if(!_(e))throw TypeError(String(e)+" is not an object");return e};var P=Object.defineProperty;tL=u?P:function(e,t,n){if(x(e),t=b(t,!0),x(n),S)try{return P(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e},L=u?function(e,t,n){return tL(e,t,p(1,n))}:function(e,t,n){return e[t]=n,e};var C={},z={};z=function(e,t){try{L(s,e,t)}catch(n){s[e]=t}return t};var D={},F={},N="__core-js_shared__";F=s[N]||z(N,{});var M=Function.toString;"function"!=typeof F.inspectSource&&(F.inspectSource=function(e){return M.call(e)}),D=F.inspectSource;var Z={},R={},K=s.WeakMap;R="function"==typeof K&&/native code/.test(D(K));var W={},H={},$={};$=!1,(H=function(e,t){return F[e]||(F[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.6.5",mode:$?"pure":"global",copyright:"\xa9 2020 Denis Pushkarev (zloirock.ru)"});var U={},X=0,V=Math.random();U=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++X+V).toString(36)};var A=H("keys");W=function(e){return A[e]||(A[e]=U(e))};var J={};J={};var G=s.WeakMap;if(R){var q=new G,Y=q.get,B=q.has,Q=q.set;tx=function(e,t){return Q.call(q,e,t),t},tP=function(e){return Y.call(q,e)||{}},tC=function(e){return B.call(q,e)}}else{var ee=W("state");J[ee]=!0,tx=function(e,t){return L(e,ee,t),t},tP=function(e){return k(e,ee)?e[ee]:{}},tC=function(e){return k(e,ee)}}var et=(Z={set:tx,get:tP,has:tC,enforce:function(e){return tC(e)?tP(e):tx(e,{})},getterFor:function(e){return function(t){var n;if(!_(t)||(n=tP(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}}).get,en=Z.enforce,ei=String(String).split("String");(C=function(e,t,n,i){var r=!!i&&!!i.unsafe,o=!!i&&!!i.enumerable,a=!!i&&!!i.noTargetGet;if("function"==typeof n&&("string"!=typeof t||k(n,"name")||L(n,"name",t),en(n).source=ei.join("string"==typeof t?t:"")),e===s){o?e[t]=n:z(t,n);return}r?!a&&e[t]&&(o=!0):delete e[t],o?e[t]=n:L(e,t,n)})(Function.prototype,"toString",function(){return"function"==typeof this&&et(this).source||D(this)});var er={},eo={},ea={},es={};es=s;var ec=function(e){return"function"==typeof e?e:void 0};ea=function(e,t){return arguments.length<2?ec(es[e])||ec(s[e]):es[e]&&es[e][t]||s[e]&&s[e][t]};var eu={},el={},ed={},eh=Math.ceil,ep=Math.floor;ed=function(e){return isNaN(e=+e)?0:(e>0?ep:eh)(e)};var ef=Math.min;el=function(e){return e>0?ef(ed(e),9007199254740991):0};var em={},eg=Math.max,ey=Math.min;em=function(e,t){var n=ed(e);return n<0?eg(n+t,0):ey(n,t)};var ev=function(e){return function(t,n,i){var r,o=f(t),a=el(o.length),s=em(i,a);if(e&&n!=n){for(;a>s;)if((r=o[s++])!=r)return!0}else for(;a>s;s++)if((e||s in o)&&o[s]===n)return e||s||0;return!e&&-1}},ew={includes:ev(!0),indexOf:ev(!1)}.indexOf;eu=function(e,t){var n,i=f(e),r=0,o=[];for(n in i)!k(J,n)&&k(i,n)&&o.push(n);for(;t.length>r;)k(i,n=t[r++])&&(~ew(o,n)||o.push(n));return o};var eb=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"].concat("length","prototype");tz=Object.getOwnPropertyNames||function(e){return eu(e,eb)},tD=Object.getOwnPropertySymbols,eo=ea("Reflect","ownKeys")||function(e){var t=tz(x(e));return tD?t.concat(tD(e)):t},er=function(e,t){for(var n=eo(t),i=0;i<n.length;i++){var r=n[i];k(e,r)||tL(e,r,tE(t,r))}};var e_={},ek=/#|\.prototype\./,eI=function(e,t){var n=eT[eS(e)];return n==eE||n!=eO&&("function"==typeof t?l(t):!!t)},eS=eI.normalize=function(e){return String(e).replace(ek,".").toLowerCase()},eT=eI.data={},eO=eI.NATIVE="N",eE=eI.POLYFILL="P";e_=eI,a=function(e,t){var n,i,r,o,a,c=e.target,u=e.global,l=e.stat;if(n=u?s:l?s[c]||z(c,{}):(s[c]||{}).prototype)for(i in t){if(o=t[i],r=e.noTargetGet?(a=tE(n,i))&&a.value:n[i],!e_(u?i:c+(l?".":"#")+i,e.forced)&&void 0!==r){if(typeof o==typeof r)continue;er(o,r)}(e.sham||r&&r.sham)&&L(o,"sham",!0),C(n,i,o,e)}};var ej={},eL={},ex={};ex=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e},eL=function(e,t,n){if(ex(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)}}return function(){return e.apply(t,arguments)}};var eP={};eP=ea("document","documentElement");var eC={},ez={};ez=ea("navigator","userAgent")||"",eC=/(iphone|ipod|ipad).*applewebkit/i.test(ez);var eD=s.location,eF=s.setImmediate,eN=s.clearImmediate,eM=s.process,eZ=s.MessageChannel,eR=s.Dispatch,eK=0,eW={},eH="onreadystatechange",e$=function(e){if(eW.hasOwnProperty(e)){var t=eW[e];delete eW[e],t()}},eU=function(e){return function(){e$(e)}},eX=function(e){e$(e.data)},eV=function(e){s.postMessage(e+"",eD.protocol+"//"+eD.host)};function eA(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>t.indexOf(i)&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)0>t.indexOf(i[r])&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}eF&&eN||(eF=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return eW[++eK]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},tF(eK),eK},eN=function(e){delete eW[e]},"process"==g(eM)?tF=function(e){eM.nextTick(eU(e))}:eR&&eR.now?tF=function(e){eR.now(eU(e))}:eZ&&!eC?(tM=(tN=new eZ).port2,tN.port1.onmessage=eX,tF=eL(tM.postMessage,tM,1)):!s.addEventListener||"function"!=typeof postMessage||s.importScripts||l(eV)||"file:"===eD.protocol?tF=eH in T("script")?function(e){eP.appendChild(T("script"))[eH]=function(){eP.removeChild(this),e$(e)}}:function(e){setTimeout(eU(e),0)}:(tF=eV,s.addEventListener("message",eX,!1))),ej={set:eF,clear:eN},a({global:!0,bind:!0,enumerable:!0,forced:!s.setImmediate||!s.clearImmediate},{setImmediate:ej.set,clearImmediate:ej.clear});var eJ="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{};function eG(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function eq(e,t){return e(t={exports:{}},t.exports),t.exports}var eY=eq(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){var e=this;this.locked=new Map,this.addToLocked=function(t,n){var i=e.locked.get(t);void 0===i?void 0===n?e.locked.set(t,[]):e.locked.set(t,[n]):void 0!==n&&(i.unshift(n),e.locked.set(t,i))},this.isLocked=function(t){return e.locked.has(t)},this.lock=function(t){return new Promise(function(n,i){e.isLocked(t)?e.addToLocked(t,n):(e.addToLocked(t),n())})},this.unlock=function(t){var n=e.locked.get(t);if(void 0!==n&&0!==n.length){var i=n.pop();e.locked.set(t,n),void 0!==i&&setTimeout(i,0)}else e.locked.delete(t)}}return e.getInstance=function(){return void 0===e.instance&&(e.instance=new e),e.instance},e}();t.default=function(){return n.getInstance()}});eG(eY);var eB=eG(eq(function(e,t){var n=eJ&&eJ.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(a,s)}c((i=i.apply(e,t||[])).next())})},i=eJ&&eJ.__generator||function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var r="browser-tabs-lock-key";function o(e){return new Promise(function(t){return setTimeout(t,e)})}function a(e){for(var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",n="",i=0;i<e;i++)n+=t[Math.floor(Math.random()*t.length)];return n}var s=function(){function e(){this.acquiredIatSet=new Set,this.id=Date.now().toString()+a(15),this.acquireLock=this.acquireLock.bind(this),this.releaseLock=this.releaseLock.bind(this),this.releaseLock__private__=this.releaseLock__private__.bind(this),this.waitForSomethingToChange=this.waitForSomethingToChange.bind(this),this.refreshLockWhileAcquired=this.refreshLockWhileAcquired.bind(this),void 0===e.waiters&&(e.waiters=[])}return e.prototype.acquireLock=function(t,s){return void 0===s&&(s=5e3),n(this,void 0,void 0,function(){var n,c,u,l,d,h;return i(this,function(i){switch(i.label){case 0:n=Date.now()+a(4),c=Date.now()+s,u=r+"-"+t,l=window.localStorage,i.label=1;case 1:return Date.now()<c?[4,o(30)]:[3,8];case 2:return i.sent(),null!==l.getItem(u)?[3,5]:(d=this.id+"-"+t+"-"+n,[4,o(Math.floor(25*Math.random()))]);case 3:return i.sent(),l.setItem(u,JSON.stringify({id:this.id,iat:n,timeoutKey:d,timeAcquired:Date.now(),timeRefreshed:Date.now()})),[4,o(30)];case 4:return i.sent(),null!==(h=l.getItem(u))&&(h=JSON.parse(h)).id===this.id&&h.iat===n?(this.acquiredIatSet.add(n),this.refreshLockWhileAcquired(u,n),[2,!0]):[3,7];case 5:return e.lockCorrector(),[4,this.waitForSomethingToChange(c)];case 6:i.sent(),i.label=7;case 7:return n=Date.now()+a(4),[3,1];case 8:return[2,!1]}})})},e.prototype.refreshLockWhileAcquired=function(e,t){return n(this,void 0,void 0,function(){var r=this;return i(this,function(o){return setTimeout(function(){return n(r,void 0,void 0,function(){var n,r;return i(this,function(i){switch(i.label){case 0:return[4,eY.default().lock(t)];case 1:return i.sent(),this.acquiredIatSet.has(t)?null===(r=(n=window.localStorage).getItem(e))?(eY.default().unlock(t),[2]):((r=JSON.parse(r)).timeRefreshed=Date.now(),n.setItem(e,JSON.stringify(r)),eY.default().unlock(t),this.refreshLockWhileAcquired(e,t),[2]):(eY.default().unlock(t),[2])}})})},1e3),[2]})})},e.prototype.waitForSomethingToChange=function(t){return n(this,void 0,void 0,function(){return i(this,function(n){switch(n.label){case 0:return[4,new Promise(function(n){var i=!1,r=Date.now(),o=!1;function a(){if(o||(window.removeEventListener("storage",a),e.removeFromWaiting(a),clearTimeout(s),o=!0),!i){i=!0;var t=50-(Date.now()-r);t>0?setTimeout(n,t):n()}}window.addEventListener("storage",a),e.addToWaiting(a);var s=setTimeout(a,Math.max(0,t-Date.now()))})];case 1:return n.sent(),[2]}})})},e.addToWaiting=function(t){this.removeFromWaiting(t),void 0!==e.waiters&&e.waiters.push(t)},e.removeFromWaiting=function(t){void 0!==e.waiters&&(e.waiters=e.waiters.filter(function(e){return e!==t}))},e.notifyWaiters=function(){void 0!==e.waiters&&e.waiters.slice().forEach(function(e){return e()})},e.prototype.releaseLock=function(e){return n(this,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return[4,this.releaseLock__private__(e)];case 1:return[2,t.sent()]}})})},e.prototype.releaseLock__private__=function(t){return n(this,void 0,void 0,function(){var n,o,a;return i(this,function(i){switch(i.label){case 0:return n=window.localStorage,o=r+"-"+t,null===(a=n.getItem(o))?[2]:(a=JSON.parse(a)).id!==this.id?[3,2]:[4,eY.default().lock(a.iat)];case 1:i.sent(),this.acquiredIatSet.delete(a.iat),n.removeItem(o),eY.default().unlock(a.iat),e.notifyWaiters(),i.label=2;case 2:return[2]}})})},e.lockCorrector=function(){for(var t=Date.now()-5e3,n=window.localStorage,i=Object.keys(n),o=!1,a=0;a<i.length;a++){var s=i[a];if(s.includes(r)){var c=n.getItem(s);null!==c&&(void 0===(c=JSON.parse(c)).timeRefreshed&&c.timeAcquired<t||void 0!==c.timeRefreshed&&c.timeRefreshed<t)&&(n.removeItem(s),o=!0)}}o&&e.notifyWaiters()},e.waiters=void 0,e}();t.default=s}));const eQ={timeoutInSeconds:60},e0={name:"auth0-spa-js",version:"2.0.8"},e1=()=>Date.now();class e2 extends Error{constructor(e,t){super(t),this.error=e,this.error_description=t,Object.setPrototypeOf(this,e2.prototype)}static fromPayload({error:e,error_description:t}){return new e2(e,t)}}class e3 extends e2{constructor(e,t,n,i=null){super(e,t),this.state=n,this.appState=i,Object.setPrototypeOf(this,e3.prototype)}}class e9 extends e2{constructor(){super("timeout","Timeout"),Object.setPrototypeOf(this,e9.prototype)}}class e5 extends e9{constructor(e){super(),this.popup=e,Object.setPrototypeOf(this,e5.prototype)}}class e4 extends e2{constructor(e){super("cancelled","Popup closed"),this.popup=e,Object.setPrototypeOf(this,e4.prototype)}}class e7 extends e2{constructor(e,t,n){super(e,t),this.mfa_token=n,Object.setPrototypeOf(this,e7.prototype)}}class e6 extends e2{constructor(e,t){super("missing_refresh_token",`Missing Refresh Token (audience: '${e8(e,["default"])}', scope: '${e8(t)}')`),this.audience=e,this.scope=t,Object.setPrototypeOf(this,e6.prototype)}}function e8(e,t=[]){return e&&!t.includes(e)?e:""}const te=()=>window.crypto,tt=()=>{let e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_~.",t="";return Array.from(te().getRandomValues(new Uint8Array(43))).forEach(n=>t+=e[n%e.length]),t},tn=e=>btoa(e),ti=e=>{var t,{clientId:n}=e,i=eA(e,["clientId"]);return new URLSearchParams(Object.keys(t=Object.assign({client_id:n},i)).filter(e=>void 0!==t[e]).reduce((e,n)=>Object.assign(Object.assign({},e),{[n]:t[n]}),{})).toString()},tr=e=>decodeURIComponent(atob(e.replace(/_/g,"/").replace(/-/g,"+")).split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join("")),to=async(e,t)=>{let n=await fetch(e,t);return{ok:n.ok,json:await n.json()}},ta=async(e,t,n)=>{let i;let r=new AbortController;return t.signal=r.signal,Promise.race([to(e,t),new Promise((e,t)=>{i=setTimeout(()=>{r.abort(),t(Error("Timeout when executing 'fetch'"))},n)})]).finally(()=>{clearTimeout(i)})},ts=async(e,t,n,i,r,o,a)=>{var s;return s={auth:{audience:t,scope:n},timeout:r,fetchUrl:e,fetchOptions:i,useFormData:a},new Promise(function(e,t){let n=new MessageChannel;n.port1.onmessage=function(i){i.data.error?t(Error(i.data.error)):e(i.data),n.port1.close()},o.postMessage(s,[n.port2])})},tc=async(e,t,n,i,r,o,a=1e4)=>r?ts(e,t,n,i,a,r,o):ta(e,i,a);async function tu(e,t){var{baseUrl:n,timeout:i,audience:r,scope:o,auth0Client:a,useFormData:s}=e,c=eA(e,["baseUrl","timeout","audience","scope","auth0Client","useFormData"]);let u=s?ti(c):JSON.stringify(c);return await async function(e,t,n,i,r,o,a){let s,c=null;for(let u=0;u<3;u++)try{s=await tc(e,n,i,r,o,a,t),c=null;break}catch(e){c=e}if(c)throw c;let u=s.json,{error:l,error_description:d}=u,h=eA(u,["error","error_description"]),{ok:p}=s;if(!p){let t=d||`HTTP error. Unable to fetch ${e}`;if("mfa_required"===l)throw new e7(l,t,h.mfa_token);if("missing_refresh_token"===l)throw new e6(n,i);throw new e2(l||"request_error",t)}return h}(`${n}/oauth/token`,i,r||"default",o,{method:"POST",body:u,headers:{"Content-Type":s?"application/x-www-form-urlencoded":"application/json","Auth0-Client":btoa(JSON.stringify(a||e0))}},t,s)}const tl=(...e)=>{var t;return(t=e.filter(Boolean).join(" ").trim().split(/\s+/),Array.from(new Set(t))).join(" ")};class th{constructor(e,t="@@auth0spajs@@",n){this.prefix=t,this.suffix=n,this.clientId=e.clientId,this.scope=e.scope,this.audience=e.audience}toKey(){return[this.prefix,this.clientId,this.audience,this.scope,this.suffix].filter(Boolean).join("::")}static fromKey(e){let[t,n,i,r]=e.split("::");return new th({clientId:n,scope:r,audience:i},t)}static fromCacheEntry(e){let{scope:t,audience:n,client_id:i}=e;return new th({scope:t,audience:n,clientId:i})}}class tp{set(e,t){localStorage.setItem(e,JSON.stringify(t))}get(e){let t=window.localStorage.getItem(e);if(t)try{return JSON.parse(t)}catch(e){return}}remove(e){localStorage.removeItem(e)}allKeys(){return Object.keys(window.localStorage).filter(e=>e.startsWith("@@auth0spajs@@"))}}class tf{constructor(){this.enclosedCache=function(){let e={};return{set(t,n){e[t]=n},get(t){let n=e[t];if(n)return n},remove(t){delete e[t]},allKeys:()=>Object.keys(e)}}()}}class tm{constructor(e,t,n){this.cache=e,this.keyManifest=t,this.nowProvider=n||e1}async setIdToken(e,t,n){var i;let r=this.getIdTokenCacheKey(e);await this.cache.set(r,{id_token:t,decodedToken:n}),await (null===(i=this.keyManifest)||void 0===i?void 0:i.add(r))}async getIdToken(e){let t=await this.cache.get(this.getIdTokenCacheKey(e.clientId));if(!t&&e.scope&&e.audience){let t=await this.get(e);if(!t||!t.id_token||!t.decodedToken)return;return{id_token:t.id_token,decodedToken:t.decodedToken}}if(t)return{id_token:t.id_token,decodedToken:t.decodedToken}}async get(e,t=0){var n;let i=await this.cache.get(e.toKey());if(!i){let t=await this.getCacheKeys();if(!t)return;let n=this.matchExistingCacheKey(e,t);n&&(i=await this.cache.get(n))}if(!i)return;let r=await this.nowProvider();return i.expiresAt-t<Math.floor(r/1e3)?i.body.refresh_token?(i.body={refresh_token:i.body.refresh_token},await this.cache.set(e.toKey(),i),i.body):(await this.cache.remove(e.toKey()),void await (null===(n=this.keyManifest)||void 0===n?void 0:n.remove(e.toKey()))):i.body}async set(e){var t;let n=new th({clientId:e.client_id,scope:e.scope,audience:e.audience}),i=await this.wrapCacheEntry(e);await this.cache.set(n.toKey(),i),await (null===(t=this.keyManifest)||void 0===t?void 0:t.add(n.toKey()))}async clear(e){var t;let n=await this.getCacheKeys();n&&(await n.filter(t=>!e||t.includes(e)).reduce(async(e,t)=>{await e,await this.cache.remove(t)},Promise.resolve()),await (null===(t=this.keyManifest)||void 0===t?void 0:t.clear()))}async wrapCacheEntry(e){let t=await this.nowProvider();return{body:e,expiresAt:Math.floor(t/1e3)+e.expires_in}}async getCacheKeys(){var e;return this.keyManifest?null===(e=await this.keyManifest.get())||void 0===e?void 0:e.keys:this.cache.allKeys?this.cache.allKeys():void 0}getIdTokenCacheKey(e){return new th({clientId:e},"@@auth0spajs@@","@@user@@").toKey()}matchExistingCacheKey(e,t){return t.filter(t=>{var n;let i=th.fromKey(t),r=new Set(i.scope&&i.scope.split(" ")),o=(null===(n=e.scope)||void 0===n?void 0:n.split(" "))||[],a=i.scope&&o.reduce((e,t)=>e&&r.has(t),!0);return"@@auth0spajs@@"===i.prefix&&i.clientId===e.clientId&&i.audience===e.audience&&a})[0]}}class tg{constructor(e,t,n){this.storage=e,this.clientId=t,this.cookieDomain=n,this.storageKey=`a0.spajs.txs.${this.clientId}`}create(e){this.storage.save(this.storageKey,e,{daysUntilExpire:1,cookieDomain:this.cookieDomain})}get(){return this.storage.get(this.storageKey)}remove(){this.storage.remove(this.storageKey,{cookieDomain:this.cookieDomain})}}const ty=e=>"number"==typeof e,tv=["iss","aud","exp","nbf","iat","jti","azp","nonce","auth_time","at_hash","c_hash","acr","amr","sub_jwk","cnf","sip_from_tag","sip_date","sip_callid","sip_cseq_num","sip_via_branch","orig","dest","mky","events","toe","txn","rph","sid","vot","vtm"],tw=e=>{if(!e.id_token)throw Error("ID token is required but missing");let t=(e=>{let t=e.split("."),[n,i,r]=t;if(3!==t.length||!n||!i||!r)throw Error("ID token could not be decoded");let o=JSON.parse(tr(i)),a={__raw:e},s={};return Object.keys(o).forEach(e=>{a[e]=o[e],tv.includes(e)||(s[e]=o[e])}),{encoded:{header:n,payload:i,signature:r},header:JSON.parse(tr(n)),claims:a,user:s}})(e.id_token);if(!t.claims.iss)throw Error("Issuer (iss) claim must be a string present in the ID token");if(t.claims.iss!==e.iss)throw Error(`Issuer (iss) claim mismatch in the ID token; expected "${e.iss}", found "${t.claims.iss}"`);if(!t.user.sub)throw Error("Subject (sub) claim must be a string present in the ID token");if("RS256"!==t.header.alg)throw Error(`Signature algorithm of "${t.header.alg}" is not supported. Expected the ID token to be signed with "RS256".`);if(!t.claims.aud||"string"!=typeof t.claims.aud&&!Array.isArray(t.claims.aud))throw Error("Audience (aud) claim must be a string or array of strings present in the ID token");if(Array.isArray(t.claims.aud)){if(!t.claims.aud.includes(e.aud))throw Error(`Audience (aud) claim mismatch in the ID token; expected "${e.aud}" but was not one of "${t.claims.aud.join(", ")}"`);if(t.claims.aud.length>1){if(!t.claims.azp)throw Error("Authorized Party (azp) claim must be a string present in the ID token when Audience (aud) claim has multiple values");if(t.claims.azp!==e.aud)throw Error(`Authorized Party (azp) claim mismatch in the ID token; expected "${e.aud}", found "${t.claims.azp}"`)}}else if(t.claims.aud!==e.aud)throw Error(`Audience (aud) claim mismatch in the ID token; expected "${e.aud}" but found "${t.claims.aud}"`);if(e.nonce){if(!t.claims.nonce)throw Error("Nonce (nonce) claim must be a string present in the ID token");if(t.claims.nonce!==e.nonce)throw Error(`Nonce (nonce) claim mismatch in the ID token; expected "${e.nonce}", found "${t.claims.nonce}"`)}if(e.max_age&&!ty(t.claims.auth_time))throw Error("Authentication Time (auth_time) claim must be a number present in the ID token when Max Age (max_age) is specified");if(null==t.claims.exp||!ty(t.claims.exp))throw Error("Expiration Time (exp) claim must be a number present in the ID token");if(!ty(t.claims.iat))throw Error("Issued At (iat) claim must be a number present in the ID token");let n=e.leeway||60,i=new Date(e.now||Date.now()),r=new Date(0);if(r.setUTCSeconds(t.claims.exp+n),i>r)throw Error(`Expiration Time (exp) claim error in the ID token; current time (${i}) is after expiration time (${r})`);if(null!=t.claims.nbf&&ty(t.claims.nbf)){let e=new Date(0);if(e.setUTCSeconds(t.claims.nbf-n),i<e)throw Error(`Not Before time (nbf) claim in the ID token indicates that this token can't be used just yet. Current time (${i}) is before ${e}`)}if(null!=t.claims.auth_time&&ty(t.claims.auth_time)){let r=new Date(0);if(r.setUTCSeconds(parseInt(t.claims.auth_time)+e.max_age+n),i>r)throw Error(`Authentication Time (auth_time) claim in the ID token indicates that too much time has passed since the last end-user authentication. Current time (${i}) is after last auth at ${r}`)}if(e.organizationId){if(!t.claims.org_id)throw Error("Organization ID (org_id) claim must be a string present in the ID token");if(e.organizationId!==t.claims.org_id)throw Error(`Organization ID (org_id) claim mismatch in the ID token; expected "${e.organizationId}", found "${t.claims.org_id}"`)}return t};var tb=eq(function(e,t){var n=eJ&&eJ.__assign||function(){return(n=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function i(e,t){if(!t)return"";var n="; "+e;return!0===t?n:n+"="+t}function r(e,t,n){return encodeURIComponent(e).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/\(/g,"%28").replace(/\)/g,"%29")+"="+encodeURIComponent(t).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent)+function(e){if("number"==typeof e.expires){var t=new Date;t.setMilliseconds(t.getMilliseconds()+864e5*e.expires),e.expires=t}return i("Expires",e.expires?e.expires.toUTCString():"")+i("Domain",e.domain)+i("Path",e.path)+i("Secure",e.secure)+i("SameSite",e.sameSite)}(n)}function o(e){for(var t={},n=e?e.split("; "):[],i=/(%[\dA-F]{2})+/gi,r=0;r<n.length;r++){var o=n[r].split("="),a=o.slice(1).join("=");'"'===a.charAt(0)&&(a=a.slice(1,-1));try{t[o[0].replace(i,decodeURIComponent)]=a.replace(i,decodeURIComponent)}catch(e){}}return t}function a(){return o(document.cookie)}function s(e,t,i){document.cookie=r(e,t,n({path:"/"},i))}t.__esModule=!0,t.encode=r,t.parse=o,t.getAll=a,t.get=function(e){return a()[e]},t.set=s,t.remove=function(e,t){s(e,"",n(n({},t),{expires:-1}))}});eG(tb),tb.encode,tb.parse,tb.getAll;var t_=tb.get,tk=tb.set,tI=tb.remove;const tS={get(e){let t=t_(e);if(void 0!==t)return JSON.parse(t)},save(e,t,n){let i={};"https:"===window.location.protocol&&(i={secure:!0,sameSite:"none"}),(null==n?void 0:n.daysUntilExpire)&&(i.expires=n.daysUntilExpire),(null==n?void 0:n.cookieDomain)&&(i.domain=n.cookieDomain),tk(e,JSON.stringify(t),i)},remove(e,t){let n={};(null==t?void 0:t.cookieDomain)&&(n.domain=t.cookieDomain),tI(e,n)}},tT={get(e){let t=tS.get(e);return t||tS.get(`_legacy_${e}`)},save(e,t,n){let i={};"https:"===window.location.protocol&&(i={secure:!0}),(null==n?void 0:n.daysUntilExpire)&&(i.expires=n.daysUntilExpire),(null==n?void 0:n.cookieDomain)&&(i.domain=n.cookieDomain),tk(`_legacy_${e}`,JSON.stringify(t),i),tS.save(e,t,n)},remove(e,t){let n={};(null==t?void 0:t.cookieDomain)&&(n.domain=t.cookieDomain),tI(e,n),tS.remove(e,t),tS.remove(`_legacy_${e}`,t)}},tO={get(e){if("undefined"==typeof sessionStorage)return;let t=sessionStorage.getItem(e);return null!=t?JSON.parse(t):void 0},save(e,t){sessionStorage.setItem(e,JSON.stringify(t))},remove(e){sessionStorage.removeItem(e)}};var tE,tj,tL,tx,tP,tC,tz,tD,tF,tN,tM,tZ,tR=function(e){var t,n,i,r;return tZ=tZ||(n=(t=function(e,t){var n=atob(e);if(t){for(var i=new Uint8Array(n.length),r=0,o=n.length;r<o;++r)i[r]=n.charCodeAt(r);return String.fromCharCode.apply(null,new Uint16Array(i.buffer))}return n}("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwohZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7Y2xhc3MgZSBleHRlbmRzIEVycm9ye2NvbnN0cnVjdG9yKHQscil7c3VwZXIociksdGhpcy5lcnJvcj10LHRoaXMuZXJyb3JfZGVzY3JpcHRpb249cixPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcyxlLnByb3RvdHlwZSl9c3RhdGljIGZyb21QYXlsb2FkKHtlcnJvcjp0LGVycm9yX2Rlc2NyaXB0aW9uOnJ9KXtyZXR1cm4gbmV3IGUodCxyKX19Y2xhc3MgdCBleHRlbmRzIGV7Y29uc3RydWN0b3IoZSxzKXtzdXBlcigibWlzc2luZ19yZWZyZXNoX3Rva2VuIixgTWlzc2luZyBSZWZyZXNoIFRva2VuIChhdWRpZW5jZTogJyR7cihlLFsiZGVmYXVsdCJdKX0nLCBzY29wZTogJyR7cihzKX0nKWApLHRoaXMuYXVkaWVuY2U9ZSx0aGlzLnNjb3BlPXMsT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsdC5wcm90b3R5cGUpfX1mdW5jdGlvbiByKGUsdD1bXSl7cmV0dXJuIGUmJiF0LmluY2x1ZGVzKGUpP2U6IiJ9Y29uc3Qgcz1lPT57dmFye2NsaWVudElkOnR9PWUscj1mdW5jdGlvbihlLHQpe3ZhciByPXt9O2Zvcih2YXIgcyBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLHMpJiZ0LmluZGV4T2Yocyk8MCYmKHJbc109ZVtzXSk7aWYobnVsbCE9ZSYmImZ1bmN0aW9uIj09dHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciBvPTA7Zm9yKHM9T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTtvPHMubGVuZ3RoO28rKyl0LmluZGV4T2Yoc1tvXSk8MCYmT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKGUsc1tvXSkmJihyW3Nbb11dPWVbc1tvXV0pfXJldHVybiByfShlLFsiY2xpZW50SWQiXSk7cmV0dXJuIG5ldyBVUkxTZWFyY2hQYXJhbXMoKGU9Pk9iamVjdC5rZXlzKGUpLmZpbHRlcigodD0+dm9pZCAwIT09ZVt0XSkpLnJlZHVjZSgoKHQscik9Pk9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx0KSx7W3JdOmVbcl19KSkse30pKShPYmplY3QuYXNzaWduKHtjbGllbnRfaWQ6dH0scikpKS50b1N0cmluZygpfTtsZXQgbz17fTtjb25zdCBuPShlLHQpPT5gJHtlfXwke3R9YDthZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIiwoYXN5bmMoe2RhdGE6e3RpbWVvdXQ6ZSxhdXRoOnIsZmV0Y2hVcmw6aSxmZXRjaE9wdGlvbnM6Yyx1c2VGb3JtRGF0YTphfSxwb3J0czpbZl19KT0+e2xldCBwO2NvbnN0e2F1ZGllbmNlOmwsc2NvcGU6dX09cnx8e307dHJ5e2NvbnN0IHI9YT8oZT0+e2NvbnN0IHQ9bmV3IFVSTFNlYXJjaFBhcmFtcyhlKSxyPXt9O3JldHVybiB0LmZvckVhY2goKChlLHQpPT57clt0XT1lfSkpLHJ9KShjLmJvZHkpOkpTT04ucGFyc2UoYy5ib2R5KTtpZighci5yZWZyZXNoX3Rva2VuJiYicmVmcmVzaF90b2tlbiI9PT1yLmdyYW50X3R5cGUpe2NvbnN0IGU9KChlLHQpPT5vW24oZSx0KV0pKGwsdSk7aWYoIWUpdGhyb3cgbmV3IHQobCx1KTtjLmJvZHk9YT9zKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxyKSx7cmVmcmVzaF90b2tlbjplfSkpOkpTT04uc3RyaW5naWZ5KE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxyKSx7cmVmcmVzaF90b2tlbjplfSkpfWxldCBkLGc7ImZ1bmN0aW9uIj09dHlwZW9mIEFib3J0Q29udHJvbGxlciYmKGQ9bmV3IEFib3J0Q29udHJvbGxlcixjLnNpZ25hbD1kLnNpZ25hbCk7dHJ5e2c9YXdhaXQgUHJvbWlzZS5yYWNlKFsoaD1lLG5ldyBQcm9taXNlKChlPT5zZXRUaW1lb3V0KGUsaCkpKSksZmV0Y2goaSxPYmplY3QuYXNzaWduKHt9LGMpKV0pfWNhdGNoKGUpe3JldHVybiB2b2lkIGYucG9zdE1lc3NhZ2Uoe2Vycm9yOmUubWVzc2FnZX0pfWlmKCFnKXJldHVybiBkJiZkLmFib3J0KCksdm9pZCBmLnBvc3RNZXNzYWdlKHtlcnJvcjoiVGltZW91dCB3aGVuIGV4ZWN1dGluZyAnZmV0Y2gnIn0pO3A9YXdhaXQgZy5qc29uKCkscC5yZWZyZXNoX3Rva2VuPygoKGUsdCxyKT0+e29bbih0LHIpXT1lfSkocC5yZWZyZXNoX3Rva2VuLGwsdSksZGVsZXRlIHAucmVmcmVzaF90b2tlbik6KChlLHQpPT57ZGVsZXRlIG9bbihlLHQpXX0pKGwsdSksZi5wb3N0TWVzc2FnZSh7b2s6Zy5vayxqc29uOnB9KX1jYXRjaChlKXtmLnBvc3RNZXNzYWdlKHtvazohMSxqc29uOntlcnJvcjplLmVycm9yLGVycm9yX2Rlc2NyaXB0aW9uOmUubWVzc2FnZX19KX12YXIgaH0pKX0oKTsKCg==",!1)).indexOf("\n",10)+1,i=t.substring(n)+"",r=new Blob([i],{type:"application/javascript"}),URL.createObjectURL(r)),new Worker(tZ,e)};const tK={};class tW{constructor(e,t){this.cache=e,this.clientId=t,this.manifestKey=this.createManifestKeyFrom(this.clientId)}async add(e){var t;let n=new Set((null===(t=await this.cache.get(this.manifestKey))||void 0===t?void 0:t.keys)||[]);n.add(e),await this.cache.set(this.manifestKey,{keys:[...n]})}async remove(e){let t=await this.cache.get(this.manifestKey);if(t){let n=new Set(t.keys);return n.delete(e),n.size>0?await this.cache.set(this.manifestKey,{keys:[...n]}):await this.cache.remove(this.manifestKey)}}get(){return this.cache.get(this.manifestKey)}clear(){return this.cache.remove(this.manifestKey)}createManifestKeyFrom(e){return`@@auth0spajs@@::${e}`}}const tH={memory:()=>(new tf).enclosedCache,localstorage:()=>new tp},t$=e=>tH[e],tU=e=>{let{openUrl:t,onRedirect:n}=e,i=eA(e,["openUrl","onRedirect"]);return Object.assign(Object.assign({},i),{openUrl:!1===t||t?t:n})},tX=new eB;class tV{constructor(e){var t,n,i;let r,o;if(this.userCache=(new tf).enclosedCache,this.defaultOptions={authorizationParams:{scope:"openid profile email"},useRefreshTokensFallback:!1,useFormData:!0},this._releaseLockOnPageHide=async()=>{await tX.releaseLock("auth0.lock.getTokenSilently"),window.removeEventListener("pagehide",this._releaseLockOnPageHide)},this.options=Object.assign(Object.assign(Object.assign({},this.defaultOptions),e),{authorizationParams:Object.assign(Object.assign({},this.defaultOptions.authorizationParams),e.authorizationParams)}),"undefined"!=typeof window&&(()=>{if(!te())throw Error("For security reasons, `window.crypto` is required to run `auth0-spa-js`.");if(void 0===te().subtle)throw Error("\n      auth0-spa-js must run on a secure origin. See https://github.com/auth0/auth0-spa-js/blob/master/FAQ.md#why-do-i-get-auth0-spa-js-must-run-on-a-secure-origin for more information.\n    ")})(),e.cache&&e.cacheLocation&&console.warn("Both `cache` and `cacheLocation` options have been specified in the Auth0Client configuration; ignoring `cacheLocation` and using `cache`."),e.cache)o=e.cache;else{if(!t$(r=e.cacheLocation||"memory"))throw Error(`Invalid cache location "${r}"`);o=t$(r)()}this.httpTimeoutMs=e.httpTimeoutInSeconds?1e3*e.httpTimeoutInSeconds:1e4,this.cookieStorage=!1===e.legacySameSiteCookie?tS:tT,this.orgHintCookieName=`auth0.${this.options.clientId}.organization_hint`,this.isAuthenticatedCookieName=`auth0.${this.options.clientId}.is.authenticated`,this.sessionCheckExpiryDays=e.sessionCheckExpiryDays||1;let a=e.useCookiesForTransactions?this.cookieStorage:tO;this.scope=tl("openid",this.options.authorizationParams.scope,this.options.useRefreshTokens?"offline_access":""),this.transactionManager=new tg(a,this.options.clientId,this.options.cookieDomain),this.nowProvider=this.options.nowProvider||e1,this.cacheManager=new tm(o,o.allKeys?void 0:new tW(o,this.options.clientId),this.nowProvider),this.domainUrl=(t=this.options.domain,/^https?:\/\//.test(t)?t:`https://${t}`),this.tokenIssuer=(n=this.options.issuer,i=this.domainUrl,n?n.startsWith("https://")?n:`https://${n}/`:`${i}/`),"undefined"!=typeof window&&window.Worker&&this.options.useRefreshTokens&&"memory"===r&&(this.worker=new tR)}_url(e){let t=encodeURIComponent(btoa(JSON.stringify(this.options.auth0Client||e0)));return`${this.domainUrl}${e}&auth0Client=${t}`}_authorizeUrl(e){return this._url(`/authorize?${ti(e)}`)}async _verifyIdToken(e,t,n){var i;let r=await this.nowProvider();return tw({iss:this.tokenIssuer,aud:this.options.clientId,id_token:e,nonce:t,organizationId:n,leeway:this.options.leeway,max_age:"string"!=typeof(i=this.options.authorizationParams.max_age)?i:parseInt(i,10)||void 0,now:r})}_processOrgIdHint(e){e?this.cookieStorage.save(this.orgHintCookieName,e,{daysUntilExpire:this.sessionCheckExpiryDays,cookieDomain:this.options.cookieDomain}):this.cookieStorage.remove(this.orgHintCookieName,{cookieDomain:this.options.cookieDomain})}async _prepareAuthorizeUrl(e,t,n){var i,r,o,a;let s=tn(tt()),c=tn(tt()),u=tt(),l=(e=>{let t=new Uint8Array(e);return(e=>{let t={"+":"-","/":"_","=":""};return e.replace(/[+/=]/g,e=>t[e])})(window.btoa(String.fromCharCode(...Array.from(t))))})(await (async e=>{let t=te().subtle.digest({name:"SHA-256"},(new TextEncoder).encode(e));return await t})(u)),d=(i=this.options,r=this.scope,o=e.redirect_uri||this.options.authorizationParams.redirect_uri||n,a=null==t?void 0:t.response_mode,Object.assign(Object.assign(Object.assign({client_id:i.clientId},i.authorizationParams),e),{scope:tl(r,e.scope),response_type:"code",response_mode:a||"query",state:s,nonce:c,redirect_uri:o||i.authorizationParams.redirect_uri,code_challenge:l,code_challenge_method:"S256"})),h=this._authorizeUrl(d);return{nonce:c,code_verifier:u,scope:d.scope,audience:d.audience||"default",redirect_uri:d.redirect_uri,state:s,url:h}}async loginWithPopup(e,t){var n,i;if(e=e||{},!(t=t||{}).popup&&(t.popup=(e=>{let t=window.screenX+(window.innerWidth-400)/2,n=window.screenY+(window.innerHeight-600)/2;return window.open("","auth0:authorize:popup",`left=${t},top=${n},width=400,height=600,resizable,scrollbars=yes,status=1`)})(0),!t.popup))throw Error("Unable to open a popup for loginWithPopup - window.open returned `null`");let r=await this._prepareAuthorizeUrl(e.authorizationParams||{},{response_mode:"web_message"},window.location.origin);t.popup.location.href=r.url;let o=await (i=Object.assign(Object.assign({},t),{timeoutInSeconds:t.timeoutInSeconds||this.options.authorizeTimeoutInSeconds||60}),new Promise((e,t)=>{let n;let r=setInterval(()=>{i.popup&&i.popup.closed&&(clearInterval(r),clearTimeout(o),window.removeEventListener("message",n,!1),t(new e4(i.popup)))},1e3),o=setTimeout(()=>{clearInterval(r),t(new e5(i.popup)),window.removeEventListener("message",n,!1)},1e3*(i.timeoutInSeconds||60));n=function(a){if(a.data&&"authorization_response"===a.data.type){if(clearTimeout(o),clearInterval(r),window.removeEventListener("message",n,!1),i.popup.close(),a.data.response.error)return t(e2.fromPayload(a.data.response));e(a.data.response)}},window.addEventListener("message",n)}));if(r.state!==o.state)throw new e2("state_mismatch","Invalid state");let a=(null===(n=e.authorizationParams)||void 0===n?void 0:n.organization)||this.options.authorizationParams.organization;await this._requestToken({audience:r.audience,scope:r.scope,code_verifier:r.code_verifier,grant_type:"authorization_code",code:o.code,redirect_uri:r.redirect_uri},{nonceIn:r.nonce,organizationId:a})}async getUser(){var e;let t=await this._getIdTokenFromCache();return null===(e=null==t?void 0:t.decodedToken)||void 0===e?void 0:e.user}async getIdTokenClaims(){var e;let t=await this._getIdTokenFromCache();return null===(e=null==t?void 0:t.decodedToken)||void 0===e?void 0:e.claims}async loginWithRedirect(e={}){var t;let n=tU(e),{openUrl:i,fragment:r,appState:o}=n,a=eA(n,["openUrl","fragment","appState"]),s=(null===(t=a.authorizationParams)||void 0===t?void 0:t.organization)||this.options.authorizationParams.organization,c=await this._prepareAuthorizeUrl(a.authorizationParams||{}),{url:u}=c,l=eA(c,["url"]);this.transactionManager.create(Object.assign(Object.assign(Object.assign({},l),{appState:o}),s&&{organizationId:s}));let d=r?`${u}#${r}`:u;i?await i(d):window.location.assign(d)}async handleRedirectCallback(e=window.location.href){let t=e.split("?").slice(1);if(0===t.length)throw Error("There are no query params available for parsing.");let{state:n,code:i,error:r,error_description:o}=(e=>{e.indexOf("#")>-1&&(e=e.substring(0,e.indexOf("#")));let t=new URLSearchParams(e);return{state:t.get("state"),code:t.get("code")||void 0,error:t.get("error")||void 0,error_description:t.get("error_description")||void 0}})(t.join("")),a=this.transactionManager.get();if(!a)throw new e2("missing_transaction","Invalid state");if(this.transactionManager.remove(),r)throw new e3(r,o||r,n,a.appState);if(!a.code_verifier||a.state&&a.state!==n)throw new e2("state_mismatch","Invalid state");let s=a.organizationId,c=a.nonce,u=a.redirect_uri;return await this._requestToken(Object.assign({audience:a.audience,scope:a.scope,code_verifier:a.code_verifier,grant_type:"authorization_code",code:i},u?{redirect_uri:u}:{}),{nonceIn:c,organizationId:s}),{appState:a.appState}}async checkSession(e){if(!this.cookieStorage.get(this.isAuthenticatedCookieName)){if(!this.cookieStorage.get("auth0.is.authenticated"))return;this.cookieStorage.save(this.isAuthenticatedCookieName,!0,{daysUntilExpire:this.sessionCheckExpiryDays,cookieDomain:this.options.cookieDomain}),this.cookieStorage.remove("auth0.is.authenticated")}try{await this.getTokenSilently(e)}catch(e){}}async getTokenSilently(e={}){var t,n;let i;let r=Object.assign(Object.assign({cacheMode:"on"},e),{authorizationParams:Object.assign(Object.assign(Object.assign({},this.options.authorizationParams),e.authorizationParams),{scope:tl(this.scope,null===(t=e.authorizationParams)||void 0===t?void 0:t.scope)})}),o=await ((i=tK[n=`${this.options.clientId}::${r.authorizationParams.audience}::${r.authorizationParams.scope}`])||(i=this._getTokenSilently(r).finally(()=>{delete tK[n],i=null}),tK[n]=i),i);return e.detailedResponse?o:null==o?void 0:o.access_token}async _getTokenSilently(e){let{cacheMode:t}=e,n=eA(e,["cacheMode"]);if("off"!==t){let e=await this._getEntryFromCache({scope:n.authorizationParams.scope,audience:n.authorizationParams.audience||"default",clientId:this.options.clientId});if(e)return e}if("cache-only"!==t){if(!await (async(e,t=3)=>{for(let n=0;n<t;n++)if(await e())return!0;return!1})(()=>tX.acquireLock("auth0.lock.getTokenSilently",5e3),10))throw new e9;try{if(window.addEventListener("pagehide",this._releaseLockOnPageHide),"off"!==t){let e=await this._getEntryFromCache({scope:n.authorizationParams.scope,audience:n.authorizationParams.audience||"default",clientId:this.options.clientId});if(e)return e}let e=this.options.useRefreshTokens?await this._getTokenUsingRefreshToken(n):await this._getTokenFromIFrame(n),{id_token:i,access_token:r,oauthTokenScope:o,expires_in:a}=e;return Object.assign(Object.assign({id_token:i,access_token:r},o?{scope:o}:null),{expires_in:a})}finally{await tX.releaseLock("auth0.lock.getTokenSilently"),window.removeEventListener("pagehide",this._releaseLockOnPageHide)}}}async getTokenWithPopup(e={},t={}){var n;let i=Object.assign(Object.assign({},e),{authorizationParams:Object.assign(Object.assign(Object.assign({},this.options.authorizationParams),e.authorizationParams),{scope:tl(this.scope,null===(n=e.authorizationParams)||void 0===n?void 0:n.scope)})});return t=Object.assign(Object.assign({},eQ),t),await this.loginWithPopup(i,t),(await this.cacheManager.get(new th({scope:i.authorizationParams.scope,audience:i.authorizationParams.audience||"default",clientId:this.options.clientId}))).access_token}async isAuthenticated(){return!!await this.getUser()}_buildLogoutUrl(e){null!==e.clientId?e.clientId=e.clientId||this.options.clientId:delete e.clientId;let t=e.logoutParams||{},{federated:n}=t,i=eA(t,["federated"]);return this._url(`/v2/logout?${ti(Object.assign({clientId:e.clientId},i))}`)+(n?"&federated":"")}async logout(e={}){let t=tU(e),{openUrl:n}=t,i=eA(t,["openUrl"]);null===e.clientId?await this.cacheManager.clear():await this.cacheManager.clear(e.clientId||this.options.clientId),this.cookieStorage.remove(this.orgHintCookieName,{cookieDomain:this.options.cookieDomain}),this.cookieStorage.remove(this.isAuthenticatedCookieName,{cookieDomain:this.options.cookieDomain}),this.userCache.remove("@@user@@");let r=this._buildLogoutUrl(i);n?await n(r):!1!==n&&window.location.assign(r)}async _getTokenFromIFrame(e){let t=Object.assign(Object.assign({},e.authorizationParams),{prompt:"none"}),n=this.cookieStorage.get(this.orgHintCookieName);n&&!t.organization&&(t.organization=n);let{url:i,state:r,nonce:o,code_verifier:a,redirect_uri:s,scope:c,audience:u}=await this._prepareAuthorizeUrl(t,{response_mode:"web_message"},window.location.origin);try{if(window.crossOriginIsolated)throw new e2("login_required","The application is running in a Cross-Origin Isolated context, silently retrieving a token without refresh token is not possible.");let t=e.timeoutInSeconds||this.options.authorizeTimeoutInSeconds,n=await ((e,t,n=60)=>new Promise((i,r)=>{let o;let a=window.document.createElement("iframe");a.setAttribute("width","0"),a.setAttribute("height","0"),a.style.display="none";let s=()=>{window.document.body.contains(a)&&(window.document.body.removeChild(a),window.removeEventListener("message",o,!1))},c=setTimeout(()=>{r(new e9),s()},1e3*n);o=function(e){if(e.origin!=t||!e.data||"authorization_response"!==e.data.type)return;let n=e.source;n&&n.close(),e.data.response.error?r(e2.fromPayload(e.data.response)):i(e.data.response),clearTimeout(c),window.removeEventListener("message",o,!1),setTimeout(s,2e3)},window.addEventListener("message",o,!1),window.document.body.appendChild(a),a.setAttribute("src",e)}))(i,this.domainUrl,t);if(r!==n.state)throw new e2("state_mismatch","Invalid state");let l=await this._requestToken(Object.assign(Object.assign({},e.authorizationParams),{code_verifier:a,code:n.code,grant_type:"authorization_code",redirect_uri:s,timeout:e.authorizationParams.timeout||this.httpTimeoutMs}),{nonceIn:o});return Object.assign(Object.assign({},l),{scope:c,oauthTokenScope:l.scope,audience:u})}catch(e){throw"login_required"===e.error&&this.logout({openUrl:!1}),e}}async _getTokenUsingRefreshToken(e){let t=await this.cacheManager.get(new th({scope:e.authorizationParams.scope,audience:e.authorizationParams.audience||"default",clientId:this.options.clientId}));if(!(t&&t.refresh_token||this.worker)){if(this.options.useRefreshTokensFallback)return await this._getTokenFromIFrame(e);throw new e6(e.authorizationParams.audience||"default",e.authorizationParams.scope)}let n=e.authorizationParams.redirect_uri||this.options.authorizationParams.redirect_uri||window.location.origin,i="number"==typeof e.timeoutInSeconds?1e3*e.timeoutInSeconds:null;try{let r=await this._requestToken(Object.assign(Object.assign(Object.assign({},e.authorizationParams),{grant_type:"refresh_token",refresh_token:t&&t.refresh_token,redirect_uri:n}),i&&{timeout:i}));return Object.assign(Object.assign({},r),{scope:e.authorizationParams.scope,oauthTokenScope:r.scope,audience:e.authorizationParams.audience||"default"})}catch(t){if((t.message.indexOf("Missing Refresh Token")>-1||t.message&&t.message.indexOf("invalid refresh token")>-1)&&this.options.useRefreshTokensFallback)return await this._getTokenFromIFrame(e);throw t}}async _saveEntryInCache(e){let{id_token:t,decodedToken:n}=e,i=eA(e,["id_token","decodedToken"]);this.userCache.set("@@user@@",{id_token:t,decodedToken:n}),await this.cacheManager.setIdToken(this.options.clientId,e.id_token,e.decodedToken),await this.cacheManager.set(i)}async _getIdTokenFromCache(){let e=this.options.authorizationParams.audience||"default",t=await this.cacheManager.getIdToken(new th({clientId:this.options.clientId,audience:e,scope:this.scope})),n=this.userCache.get("@@user@@");return t&&t.id_token===(null==n?void 0:n.id_token)?n:(this.userCache.set("@@user@@",t),t)}async _getEntryFromCache({scope:e,audience:t,clientId:n}){let i=await this.cacheManager.get(new th({scope:e,audience:t,clientId:n}),60);if(i&&i.access_token){let{access_token:e,oauthTokenScope:t,expires_in:n}=i,r=await this._getIdTokenFromCache();return r&&Object.assign(Object.assign({id_token:r.id_token,access_token:e},t?{scope:t}:null),{expires_in:n})}}async _requestToken(e,t){let{nonceIn:n,organizationId:i}=t||{},r=await tu(Object.assign({baseUrl:this.domainUrl,client_id:this.options.clientId,auth0Client:this.options.auth0Client,useFormData:this.options.useFormData,timeout:this.httpTimeoutMs},e),this.worker),o=await this._verifyIdToken(r.id_token,n,i);return await this._saveEntryInCache(Object.assign(Object.assign(Object.assign(Object.assign({},r),{decodedToken:o,scope:e.scope,audience:e.audience||"default"}),r.scope?{oauthTokenScope:r.scope}:null),{client_id:this.options.clientId})),this.cookieStorage.save(this.isAuthenticatedCookieName,!0,{daysUntilExpire:this.sessionCheckExpiryDays,cookieDomain:this.options.cookieDomain}),this._processOrgIdHint(o.claims.org_id),Object.assign(Object.assign({},r),{decodedToken:o})}}async function tA(e){let t=new tV(e);return await t.checkSession(),t}const tJ="https://forkify-fvelk.ondigitalocean.app/api/v1/recipes",tG=async function({auth0Client:e,url:t,method:n,uploadData:i}){let r;let o={};if(e){let t=await e.getTokenSilently();o.Authorization=`Bearer ${t}`}i&&(o["Content-Type"]="application/json",r=JSON.stringify(i));let a=fetch(t,{method:n,headers:o,body:r}),s=await Promise.race([a,new Promise(function(e,t){setTimeout(function(){t(Error("Request took too long! Timeout after 10 second"))},1e4)})]),c=await s.json();if(!s.ok)throw Error(`${c.message} (${s.status})`);return c},tq={recipe:{},search:{query:"",results:[],page:1,resultsPerPage:10},bookmarks:[],user:{}},tY=function(e){let{recipe:t}=e.data;return{id:t._id,title:t.title,publisher:t.publisher,image:t.image,servings:t.servings,cookingTime:t.cookingTime,ingredients:t.ingredients,cookingDirections:t.cookingDirections,...t.userID&&{userID:t.userID}}},tB=async function(e){try{let t=await tG({url:`${tJ}/${e}`,method:"GET"});tq.recipe=tY(t),tq.bookmarks.some(t=>t.id===e)?tq.recipe.bookmarked=!0:tq.recipe.bookmarked=!1}catch(e){throw console.error(`${e} ðŸ’¥ðŸ’¥ðŸ’¥ðŸ’¥`),e}},tQ=async function(e){try{tq.search.query=e;let t=await tG({url:`${tJ}?search=${e}`,method:"GET"});tq.search.results=t.data.recipes.map(e=>({id:e._id,title:e.title,publisher:e.publisher,image:e.image_url,...e.userID&&{userID:e.userID}})),tq.search.page=1}catch(e){throw console.error(`${e} ðŸ’¥ðŸ’¥ðŸ’¥ðŸ’¥`),e}},t0=function(e=tq.search.page){tq.search.page=e;let t=(e-1)*tq.search.resultsPerPage,n=e*tq.search.resultsPerPage;return tq.search.results.slice(t,n)},t1=function(e){tq.recipe.ingredients.forEach(t=>{t.quantity=t.quantity*e/tq.recipe.servings}),tq.recipe.servings=e},t2=function(){localStorage.setItem("bookmarks",JSON.stringify(tq.bookmarks))},t3=function(e){tq.bookmarks.push(e),e.id===tq.recipe.id&&(tq.recipe.bookmarked=!0),t2()},t9=function(e){let t=tq.bookmarks.findIndex(t=>t.id===e);tq.bookmarks.splice(t,1),e===tq.recipe.id&&(tq.recipe.bookmarked=!1),t2()};!function(){let e=localStorage.getItem("bookmarks");e&&(tq.bookmarks=JSON.parse(e))}();const t5=async function(e,t){let n=Object.entries(t).filter(e=>e[0].startsWith("ingredient")&&""!==e[1]).map(e=>{let t=e[1].split(",").map(e=>e.trim());if(3!==t.length)throw Error("Wrong ingredient fromat! Please use the correct format :)");let[n,i,r]=t;return{quantity:n?+n:null,unit:i,description:r}}),i=t.cookingDirections,r={title:t.title,image_url:t.image,publisher:t.publisher,cookingTime:+t.cookingTime,servings:+t.servings,ingredients:n,cookingDirections:i},o=await tG({auth0Client:e,url:`${tJ}`,method:"POST",uploadData:r});tq.recipe=tY(o),t3(tq.recipe)},t4=async function(e,t){await tG({auth0Client:e,url:`${tJ}/${t}`,method:"DELETE"})};var t7={};t7=new URL(o("27Lyk").resolve("geAt1"),import.meta.url).toString();class t6{_data;render(e,t=!0){if(!e||Array.isArray(e)&&0===e.length)return this.renderError();this._data=e;let n=this._generateMarkup();if(!t)return n;this._clear(),this._parentElement.insertAdjacentHTML("afterbegin",n)}update(e){this._data=e;let t=this._generateMarkup(),n=document.createRange().createContextualFragment(t),i=Array.from(n.querySelectorAll("*")),r=Array.from(this._parentElement.querySelectorAll("*"));i.forEach((e,t)=>{let n=r[t];e.isEqualNode(n)||e.firstChild?.nodeValue.trim()===""||(n.textContent=e.textContent),e.isEqualNode(n)||Array.from(e.attributes).forEach(e=>n.setAttribute(e.name,e.value))})}_clear(){this._parentElement.innerHTML=""}renderSpinner(){let e=`
      <div class="spinner">
        <svg>
          <use href="${n(t7)}#icon-loader"></use>
        </svg>
      </div>
    `;this._clear(),this._parentElement.insertAdjacentHTML("afterbegin",e)}renderError(e=this._errorMessage){let t=`
      <div class="error">
        <div>
          <svg>
            <use href="${n(t7)}#icon-alert-triangle"></use>
          </svg>
        </div>
        <p>${e}</p>
      </div>
    `;this._clear(),this._parentElement.insertAdjacentHTML("afterbegin",t)}renderMessage(e=this._message){let t=`
      <div class="message">
        <div>
          <svg>
            <use href="${n(t7)}#icon-smile"></use>
          </svg>
        </div>
        <p>${e}</p>
      </div>
    `;this._clear(),this._parentElement.insertAdjacentHTML("afterbegin",t)}}(Fraction=function(e,t){if(void 0!==e&&t)"number"==typeof e&&"number"==typeof t?(this.numerator=e,this.denominator=t):"string"==typeof e&&"string"==typeof t&&(this.numerator=parseInt(e),this.denominator=parseInt(t));else if(void 0===t){if("number"==typeof(num=e))this.numerator=num,this.denominator=1;else if("string"==typeof num){var n,i,r=num.split(" ");if(r[0]&&(n=r[0]),r[1]&&(i=r[1]),n%1==0&&i&&i.match("/"))return new Fraction(n).add(new Fraction(i));if(!n||i)return;if("string"==typeof n&&n.match("/")){var o=n.split("/");this.numerator=o[0],this.denominator=o[1]}else{if("string"==typeof n&&n.match("."))return new Fraction(parseFloat(n));this.numerator=parseInt(n),this.denominator=1}}}this.normalize()}).prototype.clone=function(){return new Fraction(this.numerator,this.denominator)},Fraction.prototype.toString=function(){if("NaN"===this.denominator)return"NaN";var e=this.numerator/this.denominator>0?Math.floor(this.numerator/this.denominator):Math.ceil(this.numerator/this.denominator),t=this.numerator%this.denominator,n=this.denominator,i=[];return 0!=e&&i.push(e),0!=t&&i.push((0===e?t:Math.abs(t))+"/"+n),i.length>0?i.join(" "):0},Fraction.prototype.rescale=function(e){return this.numerator*=e,this.denominator*=e,this},Fraction.prototype.add=function(e){var t=this.clone();return e=e instanceof Fraction?e.clone():new Fraction(e),td=t.denominator,t.rescale(e.denominator),e.rescale(td),t.numerator+=e.numerator,t.normalize()},Fraction.prototype.subtract=function(e){var t=this.clone();return e=e instanceof Fraction?e.clone():new Fraction(e),td=t.denominator,t.rescale(e.denominator),e.rescale(td),t.numerator-=e.numerator,t.normalize()},Fraction.prototype.multiply=function(e){var t=this.clone();if(e instanceof Fraction)t.numerator*=e.numerator,t.denominator*=e.denominator;else{if("number"!=typeof e)return t.multiply(new Fraction(e));t.numerator*=e}return t.normalize()},Fraction.prototype.divide=function(e){var t=this.clone();if(e instanceof Fraction)t.numerator*=e.denominator,t.denominator*=e.numerator;else{if("number"!=typeof e)return t.divide(new Fraction(e));t.denominator*=e}return t.normalize()},Fraction.prototype.equals=function(e){e instanceof Fraction||(e=new Fraction(e));var t=this.clone().normalize(),e=e.clone().normalize();return t.numerator===e.numerator&&t.denominator===e.denominator},Fraction.prototype.normalize=function(){var e=function(e){return"number"==typeof e&&(e>0&&e%1>0&&e%1<1||e<0&&e%-1<0&&e%-1>-1)},t=function(e,t){if(!t)return Math.round(e);var n=Math.pow(10,t);return Math.round(e*n)/n};return function(){if(e(this.denominator)){var n=t(this.denominator,9),i=Math.pow(10,n.toString().split(".")[1].length);this.denominator=Math.round(this.denominator*i),this.numerator*=i}if(e(this.numerator)){var n=t(this.numerator,9),i=Math.pow(10,n.toString().split(".")[1].length);this.numerator=Math.round(this.numerator*i),this.denominator*=i}var r=Fraction.gcf(this.numerator,this.denominator);return this.numerator/=r,this.denominator/=r,(this.numerator<0&&this.denominator<0||this.numerator>0&&this.denominator<0)&&(this.numerator*=-1,this.denominator*=-1),this}}(),Fraction.gcf=function(e,t){var n=[],i=Fraction.primeFactors(e),r=Fraction.primeFactors(t);return(i.forEach(function(e){var t=r.indexOf(e);t>=0&&(n.push(e),r.splice(t,1))}),0===n.length)?1:function(){var e,t=n[0];for(e=1;e<n.length;e++)t*=n[e];return t}()},Fraction.primeFactors=function(e){for(var t=Math.abs(e),n=[],i=2;i*i<=t;)t%i==0?(n.push(i),t/=i):i++;return 1!=t&&n.push(t),n},e=Fraction;class t8 extends t6{_parentElement=document.querySelector(".recipe");_errorMessage="We could not find that recipe. Please try another one!";_message="";addHandlerRender(e){["hashchange","load"].forEach(t=>window.addEventListener(t,e))}addHandlerUpdateServings(e){this._parentElement.addEventListener("click",function(t){let n=t.target.closest(".btn--update-servings");if(!n)return;let{updateTo:i}=n.dataset;+i>0&&e(+i)})}addHandlerAddBookmark(e){this._parentElement.addEventListener("click",function(t){let n=t.target.closest(".btn--bookmark");n&&e()})}addHandlerDeleteRecipe(e){this._parentElement.addEventListener("click",function(t){let n=t.target.closest(".btn--delete");n&&e()})}_generateMarkup(){let e=tq.user.sub,t=this._data;return`
      <figure class="recipe__fig">
        <img src="${this._data.image}" alt="${this._data.title}" class="recipe__img" />
        <h1 class="recipe__title">
          <span>${this._data.title}</span>
        </h1>
      </figure>

      <div class="recipe__details">
        <div class="recipe__info">
          <svg class="recipe__info-icon">
            <use href="${n(t7)}#icon-clock"></use>
          </svg>
          <span class="recipe__info-data recipe__info-data--minutes">${this._data.cookingTime}</span>
          <span class="recipe__info-text">minutes</span>
        </div>
        <div class="recipe__info">
          <svg class="recipe__info-icon">
            <use href="${n(t7)}#icon-users"></use>
          </svg>
          <span class="recipe__info-data recipe__info-data--people">${this._data.servings}</span>
          <span class="recipe__info-text">servings</span>

          <div class="recipe__info-buttons">
            <button class="btn--tiny btn--update-servings" data-update-to="${this._data.servings-1}">
              <svg>
                <use href="${n(t7)}#icon-minus-circle"></use>
              </svg>
            </button>
            <button class="btn--tiny btn--update-servings" data-update-to="${this._data.servings+1}">
              <svg>
                <use href="${n(t7)}#icon-plus-circle"></use>
              </svg>
            </button>
          </div>
        </div>

        <button class="btn--round btn--bookmark">
          <svg class="">
            <use href="${n(t7)}#icon-bookmark${this._data.bookmarked?"-fill":""}"></use>
          </svg>
        </button>

        <button class="btn btn--delete ${e&&e===t.userID?"":"hidden"}">
          Delete
        </button>

        <button class="btn btn--edit ${e&&e===t.userID?"":"hidden"}">
        Edit
      </button>
      </div>

      <div class="recipe__ingredients">
        <h2 class="heading--2">Recipe ingredients</h2>
        <ul class="recipe__ingredient-list">
          ${this._data.ingredients.map(this._generateMarkupIngredient).join("")}
      </div>

      <div class="recipe__directions">
        <h2 class="heading--2">How to cook it</h2>
        <p class="recipe__directions-text">
        ${this._data.cookingDirections}
        </p>
      </div>
    `}_generateMarkupIngredient(t){return`
    <li class="recipe__ingredient">
      <svg class="recipe__icon">
        <use href="${n(t7)}#icon-check"></use>
      </svg>
      <div class="recipe__quantity">${t.quantity?new e(t.quantity).toString():""}</div>
      <div class="recipe__description">
        <span class="recipe__unit">${t.unit}</span>
        ${t.description}
      </div>
    </li>
  `}}var ne=new t8;class nt{_parentEl=document.querySelector(".search");getQuery(){let e=this._parentEl.querySelector(".search__field").value;return this._clearInput(),e}_clearInput(){this._parentEl.querySelector(".search__field").value=""}addHandlerSearch(e){this._parentEl.addEventListener("submit",function(t){t.preventDefault(),e()})}}var nn=new nt,ni=new class extends t6{_parentElement="";_generateMarkup(){let e=window.location.hash.slice(1);return`
      <li class="preview">
        <a class="preview__link ${this._data.id===e?"preview__link--active":""}" href="#${this._data.id}">
          <figure class="preview__fig">
            <img src="${this._data.image}" alt="${this._data.title}" />
          </figure>
          <div class="preview__data">
            <h4 class="preview__title">${this._data.title}</h4>
            <p class="preview__publisher">${this._data.publisher}</p>
            <div class="preview__user-generated ${this._data.key?"":"hidden"}">
              <svg>
              <use href="${n(t7)}#icon-user"></use>
              </svg>
            </div>
          </div>
        </a>
      </li>
    `}};class nr extends t6{_parentElement=document.querySelector(".results");_errorMessage="No recipes found for your query! Please try again ;)";_message="";_generateMarkup(){return this._data.map(e=>ni.render(e,!1)).join("")}}var no=new nr;class na extends t6{_parentElement=document.querySelector(".pagination");addHandlerClick(e){this._parentElement.addEventListener("click",function(t){let n=t.target.closest(".btn--inline");if(!n)return;let i=+n.dataset.goto;e(i)})}_generateMarkup(){let e=this._data.page,t=Math.ceil(this._data.results.length/this._data.resultsPerPage);return 1===e&&t>1?`
        <button data-goto="${e+1}" class="btn--inline pagination__btn--next">
          <span>Page ${e+1}</span>
          <svg class="search__icon">
            <use href="${n(t7)}#icon-arrow-right"></use>
          </svg>
        </button>
      `:e===t&&t>1?`
        <button data-goto="${e-1}" class="btn--inline pagination__btn--prev">
          <svg class="search__icon">
            <use href="${n(t7)}#icon-arrow-left"></use>
          </svg>
          <span>Page ${e-1}</span>
        </button>
      `:e<t?`
        <button data-goto="${e-1}" class="btn--inline pagination__btn--prev">
          <svg class="search__icon">
            <use href="${n(t7)}#icon-arrow-left"></use>
          </svg>
          <span>Page ${e-1}</span>
        </button>
        <button data-goto="${e+1}" class="btn--inline pagination__btn--next">
          <span>Page ${e+1}</span>
          <svg class="search__icon">
            <use href="${n(t7)}#icon-arrow-right"></use>
          </svg>
        </button>
      `:""}}var ns=new na;class nc extends t6{_parentElement=document.querySelector(".bookmarks__list");_errorMessage="No bookmarks yet. Find a nice recipe and bookmark it ;)";_message="";addHandlerRender(e){window.addEventListener("load",e)}_generateMarkup(){return this._data.map(e=>ni.render(e,!1)).join("")}}var nu=new nc;class nl extends t6{_parentElement=document.querySelector(".upload");_message="Recipe was successfully uploaded :)";_window=document.querySelector(".add-recipe-window");_overlay=document.querySelector(".overlay");_btnOpen=document.querySelector(".nav__btn--add-recipe");_btnClose=document.querySelector(".btn--close-modal");constructor(){super(),this._addHandlerShowWindow(),this._addHandlerHideWindow()}toggleWindow(){this._overlay.classList.toggle("hidden"),this._window.classList.toggle("hidden")}_addHandlerShowWindow(){this._btnOpen.addEventListener("click",this.toggleWindow.bind(this))}_addHandlerHideWindow(){this._btnClose.addEventListener("click",this.toggleWindow.bind(this)),this._overlay.addEventListener("click",this.toggleWindow.bind(this))}addHandlerUpload(e){this._parentElement.addEventListener("submit",function(t){t.preventDefault();let n=[...new FormData(this)],i=Object.fromEntries(n);e(i)})}_generateMarkup(){}}var nd=new nl;class nh{_btnLogin=document.querySelector(".nav__btn--login");_btnLogout=document.querySelector(".nav__btn--logout");addHandlerLogin(e){this._btnLogin.addEventListener("click",function(t){t.preventDefault(),e()})}addHandlerLogout(e){this._btnLogout.addEventListener("click",function(t){t.preventDefault(),e()})}renderLogin(){this._btnLogout.classList.add("hidden"),this._btnLogin.classList.remove("hidden")}renderLogout(){this._btnLogin.classList.add("hidden"),this._btnLogout.classList.remove("hidden")}addHandlerRender(e){window.addEventListener("load",e)}}var np=new nh,nf=function(e){"use strict";var t,n=Object.prototype,i=n.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(e,n,i,r){var o,a=Object.create((n&&n.prototype instanceof m?n:m).prototype),s=new O(r||[]);return a._invoke=(o=d,function(n,r){if(o===h)throw Error("Generator is already running");if(o===p){if("throw"===n)throw r;return j()}for(s.method=n,s.arg=r;;){var a=s.delegate;if(a){var c=function e(n,i){var r=n.iterator[i.method];if(r===t){if(i.delegate=null,"throw"===i.method){if(n.iterator.return&&(i.method="return",i.arg=t,e(n,i),"throw"===i.method))return f;i.method="throw",i.arg=TypeError("The iterator does not provide a 'throw' method")}return f}var o=l(r,n.iterator,i.arg);if("throw"===o.type)return i.method="throw",i.arg=o.arg,i.delegate=null,f;var a=o.arg;return a?a.done?(i[n.resultName]=a.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,f):a:(i.method="throw",i.arg=TypeError("iterator result is not an object"),i.delegate=null,f)}(a,s);if(c){if(c===f)continue;return c}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(o===d)throw o=p,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);o=h;var u=l(e,i,s);if("normal"===u.type){if(o=s.done?p:"suspendedYield",u.arg===f)continue;return{value:u.arg,done:s.done}}"throw"===u.type&&(o=p,s.method="throw",s.arg=u.arg)}}),a}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d="suspendedStart",h="executing",p="completed",f={};function m(){}function g(){}function y(){}var v={};v[o]=function(){return this};var w=Object.getPrototypeOf,b=w&&w(w(E([])));b&&b!==n&&i.call(b,o)&&(v=b);var _=y.prototype=m.prototype=Object.create(v);function k(e){["next","throw","return"].forEach(function(t){c(e,t,function(e){return this._invoke(t,e)})})}function I(e,t){var n;this._invoke=function(r,o){function a(){return new t(function(n,a){!function n(r,o,a,s){var c=l(e[r],e,o);if("throw"===c.type)s(c.arg);else{var u=c.arg,d=u.value;return d&&"object"==typeof d&&i.call(d,"__await")?t.resolve(d.__await).then(function(e){n("next",e,a,s)},function(e){n("throw",e,a,s)}):t.resolve(d).then(function(e){u.value=e,a(u)},function(e){return n("throw",e,a,s)})}}(r,o,n,a)})}return n=n?n.then(a,a):a()}}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function E(e){if(e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function n(){for(;++r<e.length;)if(i.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:j}}function j(){return{value:t,done:!0}}return g.prototype=_.constructor=y,y.constructor=g,g.displayName=c(y,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,c(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},k(I.prototype),I.prototype[a]=function(){return this},e.AsyncIterator=I,e.async=function(t,n,i,r,o){void 0===o&&(o=Promise);var a=new I(u(t,n,i,r),o);return e.isGeneratorFunction(n)?a:a.next().then(function(e){return e.done?e.value:a.next()})},k(_),c(_,s,"Generator"),_[o]=function(){return this},_.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var i=t.pop();if(i in e)return n.value=i,n.done=!1,n}return n.done=!0,n}},e.values=E,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(i,r){return s.type="throw",s.arg=e,n.next=i,r&&(n.method="next",n.arg=t),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else if(u){if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else throw Error("try statement without catch or finally")}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return(a.type=e,a.arg=t,o)?(this.method="next",this.next=o.finallyLoc,f):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;T(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:E(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),f}},e}({});try{regeneratorRuntime=nf}catch(e){Function("r","regeneratorRuntime = r")(nf)}let nm=null;const ng=async()=>{nm=await tA({domain:"dev-5hwndgvebevysof6.eu.auth0.com",clientId:"Ks6wUNCpcoNJzejw9JC5yNupXMK183Qm",authorizationParams:{audience:"https://forkify-fvelk.ondigitalocean.app/api/v1"}});let e=window.location.search;e.includes("code=")&&e.includes("state=")&&(await nm.handleRedirectCallback(),window.history.replaceState({},document.title,"/"));let t=await nm.isAuthenticated();t&&(tq.user=await nm.getUser()),Object.keys(tq.user).length?np.renderLogout():np.renderLogin()},ny=async function(){try{let e=window.location.hash.slice(1);if(!e)return;ne.renderSpinner(),no.update(t0()),nu.update(tq.bookmarks),await tB(e),ne.render(tq.recipe)}catch(e){ne.renderError(),console.error(e)}},nv=async function(){try{no.renderSpinner();let e=nn.getQuery();if(!e)return;await tQ(e),no.render(t0()),ns.render(tq.search)}catch(e){console.log(e)}},nw=function(e){no.render(t0(e)),ns.render(tq.search)},nb=function(e){t1(e),ne.update(tq.recipe)},n_=function(){tq.recipe.bookmarked?t9(tq.recipe.id):t3(tq.recipe),ne.update(tq.recipe),nu.render(tq.bookmarks)},nk=function(){nu.render(tq.bookmarks)},nI=async function(e){try{nd.renderSpinner(),await t5(nm,e),ne.render(tq.recipe),nd.renderMessage(),nu.render(tq.bookmarks),window.history.pushState(null,"",`#${tq.recipe.id}`)}catch(e){console.error("\uD83D\uDCA5",e),nd.renderError(e.message)}},nS=async()=>{await nm.loginWithRedirect({authorizationParams:{redirect_uri:window.location.origin}})},nT=()=>{nm.logout({logoutParams:{returnTo:window.location.origin}})},nO=async()=>{let e=window.location.hash.slice(1);if(!e)throw Error("Can not delete recipe. Recipe id is missing");ne.renderSpinner(),await t4(nm,e),window.history.replaceState(null,"",location.origin),tq.search.results=tq.search.results.filter(t=>t.id!==e),tq.search.results.length?no.render(t0()):ne.renderMessage(""),ne.renderMessage("Recipe is deleted. </br> Search for a recipe or an ingredient.")},nE=async()=>{nu.addHandlerRender(nk),ne.addHandlerRender(ny),ne.addHandlerUpdateServings(nb),ne.addHandlerAddBookmark(n_),ne.addHandlerDeleteRecipe(nO),nn.addHandlerSearch(nv),ns.addHandlerClick(nw),nd.addHandlerUpload(nI),np.addHandlerRender(ng),np.addHandlerLogin(nS),np.addHandlerLogout(nT)};nE();
//# sourceMappingURL=index.4d3a67cd.js.map
